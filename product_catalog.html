<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Cat√°logo de Productos</title>
  <style>
    body { font-family: Arial, sans-serif; margin: 0; padding: 0; background: #f9f9f9; }
    header { background: #333; color: white; padding: 1rem; text-align: center; }
    .search-bar { text-align: center; margin: 1rem; }
    .search-bar input { padding: 0.5rem; width: 80%; max-width: 400px; font-size: 1rem; }
    .products-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(200px, 1fr)); gap: 1rem; padding: 1rem; }
    .card { background: white; border-radius: 8px; padding: 1rem; box-shadow: 0 2px 6px rgba(0,0,0,0.1); cursor: pointer; transition: transform 0.2s; }
    .card:hover { transform: scale(1.03); }
    .card img { width: 100%; height: 150px; object-fit: cover; border-radius: 6px; }
    .card h3 { margin: 0.5rem 0; font-size: 1.1rem; }
    .price { color: green; font-weight: bold; }
    .modal { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.6); justify-content: center; align-items: center; }
    .modal-content { background: white; padding: 1rem; border-radius: 8px; max-width: 600px; width: 90%; position: relative; }
    .close { position: absolute; top: 10px; right: 15px; font-size: 1.5rem; cursor: pointer; }
    .images { display: flex; gap: 0.5rem; overflow-x: auto; margin-top: 1rem; }
    .images img { height: 100px; border-radius: 6px; }
    .share-link { margin-top: 1rem; display: inline-block; background: #007BFF; color: white; padding: 0.5rem 1rem; border-radius: 6px; text-decoration: none; }
  </style>
</head>
<body>
  <header>
    <h1>Cat√°logo de Productos</h1>
  </header>

  <div class="search-bar">
    <input type="text" id="searchInput" placeholder="üîç Buscar productos...">
  </div>

  <div class="products-grid" id="productsGrid"></div>

  <div class="modal" id="productModal">
    <div class="modal-content">
      <span class="close" id="closeModal">&times;</span>
      <h2 id="modalName"></h2>
      <p class="price" id="modalPrice"></p>
      <p id="modalDesc"></p>
      <div class="images" id="modalImages"></div>
      <a href="#" target="_blank" id="shareLink" class="share-link">Compartir</a>
    </div>
  </div>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.4.1/papaparse.min.js"></script>
  <script>
    const sheetUrl = "TU_LINK_CSV_AQUI"; // reemplazar con el link CSV de tu Google Sheet
    let products = [];

    // Cargar datos desde Google Sheets CSV
    fetch(sheetUrl)
      .then(res => res.text())
      .then(csv => {
        const parsed = Papa.parse(csv, { header: true });
        products = parsed.data.filter(p => p.ID && p.nombre);
        displayProducts();
        checkUrlForProduct();
      });

    // Mostrar productos
    function displayProducts(searchQuery = "") {
      const grid = document.getElementById("productsGrid");
      grid.innerHTML = "";

      products
        .filter(p =>
          p.nombre.toLowerCase().includes(searchQuery) ||
          p.descripcion.toLowerCase().includes(searchQuery)
        )
        .forEach(p => {
          const card = document.createElement("div");
          card.className = "card";
          card.innerHTML = `
            <img src="${p.imagen1}" alt="${p.nombre}">
            <h3>${p.nombre}</h3>
            <p class="price">$${Number(p.precio).toLocaleString("es-CO")}</p>
          `;
          card.onclick = () => openModal(p.ID);
          grid.appendChild(card);
        });
    }

    // Abrir modal
    function openModal(productId) {
      const p = products.find(prod => prod.ID === productId);
      if (!p) return;
      document.getElementById("modalName").innerText = p.nombre;
      document.getElementById("modalPrice").innerText = "$" + Number(p.precio).toLocaleString("es-CO");
      document.getElementById("modalDesc").innerText = p.descripcion;

      const imagesDiv = document.getElementById("modalImages");
      imagesDiv.innerHTML = "";
      for (let i = 1; i <= 5; i++) {
        if (p["imagen"+i]) {
          const img = document.createElement("img");
          img.src = p["imagen"+i];
          imagesDiv.appendChild(img);
        }
      }

      const shareLink = document.getElementById("shareLink");
      shareLink.href = window.location.origin + window.location.pathname + "?producto=" + p.ID;

      document.getElementById("productModal").style.display = "flex";
    }

    // Cerrar modal
    document.getElementById("closeModal").onclick = () => {
      document.getElementById("productModal").style.display = "none";
    };

    // Buscar desde la barra
    document.getElementById("searchInput").addEventListener("input", function(e) {
      const query = e.target.value.toLowerCase();
      displayProducts(query);
    });

    // Revisar si hay producto en la URL
    function checkUrlForProduct() {
      const params = new URLSearchParams(window.location.search);
      if (params.has("producto")) {
        openModal(params.get("producto"));
      }
    }
  </script>
</body>
</html>
