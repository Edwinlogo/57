<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Cat√°logo de Productos</title>
  <style>
    /* ==============================
       üé® PALETA DE COLORES (Naranja)
       Cambia estas variables para modificar colores globales
    =============================== */
    :root {
      --color-principal: #f97316;   /* Naranja principal */
      --color-secundario: #fb923c; /* Naranja m√°s suave */
      --color-texto: #333;          /* Texto principal */
      --color-fondo: #fff;          /* Fondo general */
      --color-card: #fef3c7;        /* Fondo de tarjetas */
    }

    body {
      font-family: Arial, sans-serif;
      margin: 0;
      padding: 20px;
      background: var(--color-fondo);
      color: var(--color-texto);
    }

    /* ==============================
       üîé BUSCADOR
    =============================== */
    #search {
      width: 100%;
      padding: 12px;
      margin-bottom: 20px;
      border: 2px solid var(--color-principal);
      border-radius: 8px;
      font-size: 16px;
    }

    /* ==============================
       üìÇ BOTONES DE CATEGOR√çA
    =============================== */
    .categories {
      margin-bottom: 20px;
    }
    .category-btn {
      margin: 4px;
      padding: 8px 14px;
      border: none;
      border-radius: 6px;
      background: var(--color-secundario);
      color: white;
      cursor: pointer;
      font-size: 14px;
      transition: background 0.2s;
    }
    .category-btn:hover {
      background: var(--color-principal);
    }

    /* ==============================
       üì¶ CUADR√çCULA DE PRODUCTOS
    =============================== */
    .product-grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(250px, 1fr)); /* üîß Cambia 250px para ajustar tama√±o m√≠nimo de tarjeta */
      gap: 20px;
    }
    .product-card {
      border: 1px solid #ddd;
      border-radius: 10px;
      padding: 15px;
      text-align: center;
      background: var(--color-card);
      cursor: pointer;
      transition: transform 0.2s, box-shadow 0.2s;
    }
    .product-card:hover {
      transform: translateY(-5px);
      box-shadow: 0 6px 12px rgba(0,0,0,0.15);
    }
    .product-image {
      width: 100%;
      aspect-ratio: 1 / 1;  /* üîß Cambiar a 4/3 si quieres rect√°ngulo */
      object-fit: contain;  /* üîß Usa cover si quieres recorte estilo Instagram */
      border-radius: 8px;
      margin-bottom: 12px;
      background: #fff;
    }

    /* ==============================
       üñºÔ∏è MODAL PRODUCTO
    =============================== */
    .modal {
      display: none;
      position: fixed;
      top: 0; left: 0; width: 100%; height: 100%;
      background: rgba(0,0,0,0.7);
      justify-content: center;
      align-items: center;
      z-index: 1000;
    }
    .modal-content {
      background: white;
      padding: 25px;
      border-radius: 12px;
      max-width: 700px;
      width: 90%;
      text-align: center;
      position: relative;
    }
    .close {
      position: absolute;
      top: 10px; right: 15px;
      font-size: 28px;
      cursor: pointer;
      color: var(--color-principal);
    }

    /* ==============================
       ‚è© CARRUSEL
    =============================== */
    .carousel {
      position: relative;
      margin-bottom: 15px;
    }
    .carousel img {
      max-width: 100%;
      border-radius: 10px;
      cursor: pointer;
    }
    .carousel button {
      position: absolute;
      top: 50%;
      transform: translateY(-50%);
      background: rgba(0,0,0,0.6);
      color: white;
      border: none;
      font-size: 20px;
      padding: 8px;
      cursor: pointer;
      border-radius: 50%;
    }
    .carousel button.prev { left: 10px; }
    .carousel button.next { right: 10px; }

    /* ==============================
       üîó BOT√ìN COMPARTIR
    =============================== */
    .share-btn {
      margin-top: 12px;
      padding: 8px 14px;
      background: var(--color-principal);
      color: white;
      border: none;
      border-radius: 6px;
      cursor: pointer;
    }

    /* ==============================
       üì± RESPONSIVE
    =============================== */
    @media (max-width: 600px) {
      .product-grid {
        grid-template-columns: 1fr 1fr; /* üîß Ajusta a 1fr si quieres 1 columna en m√≥vil */
      }
    }
  </style>
</head>
<body>

  <!-- üîé Buscador de productos -->
  <input type="text" id="search" placeholder="Buscar productos...">

  <!-- üìÇ Filtros por categor√≠a -->
  <div class="categories" id="categories"></div>

  <!-- üì¶ Cuadr√≠cula din√°mica de productos -->
  <div class="product-grid" id="productGrid"></div>

  <!-- ‚¨áÔ∏è Bot√≥n para cargar m√°s productos -->
  <button id="loadMore" style="margin:20px auto; display:block; padding:10px 20px; background:var(--color-principal); color:#fff; border:none; border-radius:6px; cursor:pointer;">Cargar m√°s</button>

  <!-- üñºÔ∏è Modal con detalle de producto -->
  <div class="modal" id="productModal">
    <div class="modal-content">
      <span class="close" onclick="closeModal()">&times;</span>
      <h2 id="modalTitle"></h2>
      <div class="carousel">
        <button class="prev" onclick="prevImage()">&#10094;</button>
        <img id="modalImage" src="">
        <button class="next" onclick="nextImage()">&#10095;</button>
      </div>
      <p id="modalPrice"></p>
      <p id="modalDescription"></p>
      <button class="share-btn" onclick="shareProduct()">üîó Compartir</button>
    </div>
  </div>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.4.1/papaparse.min.js"></script>
  <script>
    /* ==============================
       üìä VARIABLES Y ESTADO GLOBAL
    =============================== */
    let products = [];          // Todos los productos cargados
    let filtered = [];          // Productos filtrados (buscador / categor√≠a)
    let currentIndex = 0;       // √çndice de producto en carrusel
    let currentImages = [];     // Im√°genes del producto actual
    let visibleProducts = 0;    // Cu√°ntos productos se muestran
    const perPage = 12;         // üîß Cantidad de productos por p√°gina

    /* ==============================
       üì• CARGA DE PRODUCTOS DESDE GOOGLE SHEETS
    =============================== */
    Papa.parse("https://docs.google.com/spreadsheets/d/e/2PACX-1vTL98VUgPTrUmCr4yEKah1YpiEZf7qnQO2cXev14OM17P52F1X8sBm17WthSRyU4SCZhRnPPJp5DVty/pub?gid=0&single=true&output=csv", {
      download: true,
      header: true,
      complete: function(results) {
        products = results.data;
        filtered = products;
        renderCategories();
        renderProducts();
      }
    });

    /* ==============================
       üìÇ RENDERIZAR CATEGOR√çAS
    =============================== */
    function renderCategories() {
      const container = document.getElementById("categories");
      const categorias = [...new Set(products.map(p => p.categoria))];
      container.innerHTML = `<button class="category-btn" onclick="filterCategory('all')">Todos</button>`;
      categorias.forEach(c => {
        container.innerHTML += `<button class="category-btn" onclick="filterCategory('${c}')">${c}</button>`;
      });
    }

    /* ==============================
       üì¶ MOSTRAR PRODUCTOS
    =============================== */
    function renderProducts() {
      const grid = document.getElementById("productGrid");
      grid.innerHTML = "";
      const toShow = filtered.slice(0, visibleProducts + perPage);
      visibleProducts = toShow.length;
      toShow.forEach((p,i) => {
        grid.innerHTML += `
          <div class="product-card" onclick="openModal(${i})">
            <img class="product-image" src="${p.imagen1}" alt="${p.nombre}">
            <h3>${p.nombre}</h3>
            <p>$${p.precio}</p>
          </div>`;
      });
      document.getElementById("loadMore").style.display = visibleProducts < filtered.length ? "block" : "none";
    }

    document.getElementById("loadMore").addEventListener("click", renderProducts);

    /* ==============================
       üîé BUSCADOR
    =============================== */
    document.getElementById("search").addEventListener("input", function(e) {
      const q = e.target.value.toLowerCase();
      filtered = products.filter(p => p.nombre.toLowerCase().includes(q) || p.descripcion.toLowerCase().includes(q));
      visibleProducts = 0;
      renderProducts();
    });

    /* ==============================
       üìÇ FILTRO POR CATEGOR√çA
    =============================== */
    function filterCategory(cat) {
      filtered = (cat === "all") ? products : products.filter(p => p.categoria === cat);
      visibleProducts = 0;
      renderProducts();
    }

    /* ==============================
       üñºÔ∏è MODAL Y CARRUSEL
    =============================== */
    function openModal(i) {
      const p = filtered[i];
      currentImages = [p.imagen1, p.imagen2, p.imagen3].filter(Boolean);
      currentIndex = 0;
      document.getElementById("modalTitle").textContent = p.nombre;
      document.getElementById("modalPrice").textContent = `$${p.precio}`;
      document.getElementById("modalDescription").textContent = p.descripcion;
      document.getElementById("modalImage").src = currentImages[0];
      document.getElementById("productModal").style.display = "flex";
      document.body.style.overflow = "hidden"; // Evita scroll en fondo
    }
    function closeModal() {
      document.getElementById("productModal").style.display = "none";
      document.body.style.overflow = "auto";
    }
    function prevImage() {
      currentIndex = (currentIndex - 1 + currentImages.length) % currentImages.length;
      document.getElementById("modalImage").src = currentImages[currentIndex];
    }
    function nextImage() {
      currentIndex = (currentIndex + 1) % currentImages.length;
      document.getElementById("modalImage").src = currentImages[currentIndex];
    }

    /* ==============================
       üîó COMPARTIR PRODUCTO
    =============================== */
    function shareProduct() {
      const link = window.location.href.split("?")[0] + "?product=" + document.getElementById("modalTitle").textContent;
      navigator.clipboard.writeText(link).then(() => {
        alert("‚úÖ Link copiado al portapapeles");
      });
    }
  </script>
</body>
</html>
